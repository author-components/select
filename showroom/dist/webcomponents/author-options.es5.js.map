{"version":3,"file":"author-options.es5.js","sources":["../src/element.js"],"sourcesContent":["class AuthorOptionsElement extends AuthorBaseElement(HTMLElement) {\n  constructor () {\n    super(`{{TEMPLATE-STRING}}`)\n\n    this.UTIL.defineProperties({\n      cherryPickedOptions: {\n        private: true\n      },\n\n      form: {\n        readonly: true,\n        get: () => this.parentNode.form\n      },\n\n      displayOptions: {\n        readonly: true,\n        get: () => {\n          let AuthorHTMLOptionsCollection = this.PRIVATE.generateAuthorHTMLOptionsCollectionConstructor()\n          let array = this.options.map(option => option.displayElement)\n          let addFunction = (element, before) => this.addOption(this.PRIVATE.generateOptionObject(element), before)\n          let removeFunction = index => this.removeOptionByIndex(index)\n          return new AuthorHTMLOptionsCollection(array, this.selectedIndex, addFunction, removeFunction)\n        }\n      },\n\n      hoveredIndex: {\n        readonly: true,\n        get: () => this.options.findIndex(option => option.displayElement.hover)\n      },\n\n      isSlave: {\n        private: true,\n        readonly: true,\n        get: () => this.parentNode.localName === 'author-select' || this.parentNode.localName === 'author-datalist'\n      },\n\n      lastSelectedIndex: {\n        private: true\n      },\n\n      multiple: {\n        readonly: true,\n        get: () => this.parentNode.multiple\n      },\n\n      options: {\n        readonly: true,\n        default: []\n      },\n\n      selectedIndices: {\n        readonly: true,\n        get: () => [...this.selectedOptions].map(option => option.index)\n      },\n\n      selectedOptions: {\n        readonly: true,\n        get: () => {\n          let nodes = this.querySelectorAll('[selected]')\n          let AuthorHTMLCollection = this.PRIVATE.generateAuthorHTMLCollectionConstructor()\n          return new AuthorHTMLCollection(nodes)\n        }\n      },\n\n      Selection: {\n        readonly: true,\n        private: true,\n        default: class {\n          constructor (options = []) {\n            this.options = options\n          }\n\n          get displayElements () {\n            return this.options.map(option => option.displayElement)\n          }\n\n          get length () {\n            return this.options.length\n          }\n\n          get first () {\n            return this.options[0]\n          }\n\n          get last () {\n            return this.options[this.options.length - 1]\n          }\n\n          append (option) {\n            this.options.push(option)\n          }\n\n          clear () {\n            this.options = []\n          }\n\n          includes (option) {\n            return this.options.includes(option)\n          }\n\n          prepend (option) {\n            this.options.unshift(option)\n          }\n\n          selectAll () {\n            this.options.forEach(option => option.selected = true)\n          }\n        }\n      },\n\n      selectionStartIndex: {\n        private: true\n      },\n\n      visibleOptions: {\n        readonly: true,\n        get: () => this.options.filter(option => !option.hidden)\n      }\n    })\n\n    this.UTIL.definePrivateMethods({\n      arrowDownHandler: evt => {\n        if (!this.multiple) {\n          let { startIndex } = evt.detail\n\n          switch (startIndex) {\n            case this.options.length - 1:\n              return\n\n            default:\n              return this.hoverOption(startIndex + 1)\n          }\n\n          return\n        }\n\n        let { lastSelectedIndex } = this.PRIVATE\n\n        if (lastSelectedIndex === this.options.length - 1) {\n          return\n        }\n\n        return this.emit('option.selected', {\n          index: lastSelectedIndex === null ? 0 : lastSelectedIndex + 1,\n          keyboard: true,\n          shiftKey: evt.detail.shiftKey,\n          ctrlKey: false,\n          metaKey: false\n        })\n      },\n\n      arrowUpHandler: evt => {\n        if (!this.multiple) {\n          let { startIndex } = evt.detail\n\n          switch (startIndex) {\n            case -1:\n            case 0:\n              return\n\n            default:\n              return this.hoverOption(startIndex - 1)\n          }\n\n          return\n        }\n\n        let { lastSelectedIndex } = this.PRIVATE\n\n        if (lastSelectedIndex === 0) {\n          return\n        }\n\n        return this.emit('option.selected', {\n          index: lastSelectedIndex === null ? this.options.length - 1 : lastSelectedIndex - 1,\n          keyboard: true,\n          shiftKey: evt.detail.shiftKey,\n          ctrlKey: false,\n          metaKey: false\n        })\n      },\n\n      diffSelections: (comparator, comparable) => {\n        return comparator.filter(option => !comparable.includes(option))\n      },\n\n      generateAuthorHTMLOptionsCollectionConstructor: () => {\n        let _p = new WeakMap()\n\n        let AuthorHTMLCollection = this.PRIVATE.generateAuthorHTMLCollectionConstructor()\n\n        let AuthorHTMLOptionsCollection = class AuthorHTMLOptionsCollection extends AuthorHTMLCollection {\n          constructor (arr, selectedIndex = -1, add, remove) {\n            super(arr)\n            this.selectedIndex = selectedIndex\n            this.add = add\n            this.remove = remove\n\n            _p.set(this, {arr})\n          }\n\n          [Symbol.toStringTag] () {\n            return 'AuthorHTMLOptionsCollection'\n          }\n        }\n\n        return AuthorHTMLOptionsCollection\n      },\n\n      generateOptgroup: optgroup => {\n        if (!customElements.get('author-optgroup')) {\n          return this.UTIL.throwError({\n            type: 'dependency',\n            vars: { name: 'author-optgroup' }\n          })\n        }\n\n        let surrogate = document.createElement('author-optgroup')\n        surrogate.id = this.UTIL.generateGuid('optgroup')\n\n        let label = optgroup.getAttribute('label')\n\n        if (!label || label.trim() === '') {\n          return this.UTIL.throwError({\n            message: '<optgroup> must have a label attribute!'\n          })\n        }\n\n        surrogate.setAttribute('label', label)\n\n        let options = optgroup.querySelectorAll('option')\n        Array.from(options).forEach(option => {\n          this.addOption(this.PRIVATE.generateOptionObject(option), null, surrogate)\n        })\n\n        return surrogate\n      },\n\n      generateOptionObject: sourceElement => {\n        if (!customElements.get('author-option')) {\n          return this.UTIL.throwError({\n            type: 'dependency',\n            vars: { name: 'author-option' }\n          })\n        }\n\n        let OptionConstructor = this.PRIVATE.generateOptionConstructor()\n        return new OptionConstructor(this, this.UTIL.generateGuid(), sourceElement, document.createElement('author-option'))\n      },\n\n      generateOptionConstructor: () => {\n        let _p = new WeakMap()\n\n        return class AuthorOptionObject {\n          constructor (parent, key, sourceElement, displayElement) {\n            this.key = key\n            this.form = parent.form\n            this.defaultSelected = sourceElement.selected\n\n            this.sourceElement = sourceElement\n            this.displayElement = displayElement\n            this.displayElement.parent = parent\n            this.displayElement.selected = sourceElement.selected\n            this.displayElement.defaultSelected = sourceElement.selected\n            this.displayElement.innerHTML = sourceElement.innerHTML\n\n            // Add additional attributes\n            Array.from(sourceElement.attributes).forEach(attr => {\n              if (typeof attr.value === 'boolean') {\n                return attr.value ? this.displayElement.setAttribute(attr.name, '') : this.displayElement.removeAttribute(attr.name)\n              }\n\n              this.displayElement.setAttribute(attr.name, attr.value)\n            })\n\n            _p.set(this, {\n              attributes: {\n                disabled: sourceElement.disabled,\n                id: sourceElement.getAttribute('id'),\n                label: sourceElement.getAttribute('label') || sourceElement.textContent.trim(),\n                selected: sourceElement.selected,\n                value: sourceElement.hasAttribute('value') ? sourceElement.getAttribute('value').trim() : null,\n                text: sourceElement.text.trim(),\n                hidden: sourceElement.hidden\n              },\n\n              setAttr: (name, value) => {\n                this.sourceElement[name] = value\n\n                if (typeof value === 'boolean') {\n                  value ? this.displayElement.setAttribute(name, '') : this.displayElement.removeAttribute(name)\n                } else {\n                  this.displayElement.setAttribute(name, value)\n                }\n\n                _p.get(this).attributes[name] = value\n              }\n            })\n          }\n\n          get disabled () {\n            return _p.get(this).attributes.disabled\n          }\n\n          set disabled (bool) {\n            _p.get(this).setAttr('disabled', bool)\n          }\n\n          get hidden () {\n            return _p.get(this).attributes.hidden\n          }\n\n          set hidden (bool) {\n            _p.get(this).setAttr('hidden', bool)\n          }\n\n          get index () {\n            return this.sourceElement.index\n          }\n\n          get id () {\n            return _p.get(this).attributes.id\n          }\n\n          set id (id) {\n            _p.get(this).setAttr('id', id)\n          }\n\n          get selected () {\n            return _p.get(this).attributes.selected\n          }\n\n          set selected (bool) {\n            _p.get(this).setAttr('selected', bool)\n          }\n\n          get label () {\n            return _p.get(this).attributes.label\n          }\n\n          set label (label) {\n            _p.get(this).setAttr('label', label)\n          }\n\n          get text () {\n            return _p.get(this).attributes.text\n          }\n\n          set text (text) {\n            _p.get(this).setAttr('text', text)\n          }\n\n          get value () {\n            return _p.get(this).attributes.value\n          }\n\n          set value (value) {\n            _p.get(this).setAttr('value', value)\n          }\n\n          remove () {\n            this.sourceElement.remove()\n            this.displayElement.remove()\n          }\n        }\n      },\n\n      getCurrentSelection: () => this.options.filter(option => option.selected),\n\n      handleClickSelection: (detail, cb) => {\n        let {\n          cherryPickedOptions,\n          getCurrentSelection,\n          lastSelectedIndex,\n          Selection,\n          selectionStartIndex\n        } = this.PRIVATE\n\n        let { index, shiftKey, ctrlKey, metaKey } = detail\n        let selectedOption = this.options[index]\n\n        if (shiftKey && lastSelectedIndex !== null) {\n          this.PRIVATE.lastSelectedIndex = index\n          this.PRIVATE.cherryPickedOptions.clear()\n          let bounds = [index, selectionStartIndex].sort((a, b) => a - b)\n          return cb(new Selection(bounds[0] === bounds[1] ? [selectedOption] : this.options.slice(bounds[0], bounds[1] + 1)))\n        }\n\n        let currentSelection = getCurrentSelection()\n\n        if (ctrlKey || metaKey) {\n          this.PRIVATE.lastSelectedIndex = index\n          this.PRIVATE.selectionStartIndex = index\n\n          this.PRIVATE.cherryPickedOptions.options = selectedOption.selected ? currentSelection.filter(option => option !== selectedOption) : this.options.filter(option => option === selectedOption || currentSelection.includes(option))\n          return cb(this.PRIVATE.cherryPickedOptions)\n        }\n\n        if (currentSelection.length === 1 && index === lastSelectedIndex) {\n          return\n        }\n\n        this.PRIVATE.lastSelectedIndex = index\n        this.PRIVATE.selectionStartIndex = index\n        this.PRIVATE.cherryPickedOptions.clear()\n        return cb(new Selection([selectedOption]))\n      },\n\n      handleKeyboardSelection: (detail, cb) => {\n        let {\n          cherryPickedOptions,\n          getCurrentSelection,\n          Selection,\n          selectionStartIndex\n        } = this.PRIVATE\n\n        let { index, shiftKey } = detail\n        let selectedOption = this.options[index]\n        let currentSelection = getCurrentSelection()\n\n        this.PRIVATE.lastSelectedIndex = index\n\n        if (!shiftKey || currentSelection.length === 0) {\n          this.PRIVATE.selectionStartIndex = index\n          this.PRIVATE.cherryPickedOptions.clear()\n          return cb(new Selection([selectedOption]))\n        }\n\n        // 1 option or more selected\n        if (currentSelection.length > 0) {\n          let bounds = [index, selectionStartIndex].sort()\n          let selection = new Selection(bounds[0] === bounds[1] ? [selectedOption] : this.options.slice(bounds[0], bounds[1] + 1))\n\n          if (cherryPickedOptions.length > 0) {\n            selection.options = this.options.filter(option => selection.includes(option) || cherryPickedOptions.includes(option))\n          }\n\n          return cb(selection)\n        }\n      },\n\n      optionSelectionHandler: evt => {\n        let {\n          cherryPickedOptions,\n          diffSelections,\n          getCurrentSelection,\n          generateAuthorHTMLCollectionConstructor,\n          handleClickSelection,\n          handleKeyboardSelection,\n          Selection\n        } = this.PRIVATE\n\n        if (cherryPickedOptions === null) {\n          this.PRIVATE.cherryPickedOptions = new Selection([])\n        }\n\n        let { index, keyboard } = evt.detail\n\n        let completeOperation = selection => {\n          let currentSelection = getCurrentSelection()\n          let comparator = selection.length >= currentSelection.length ? selection.options : currentSelection\n          let diff = diffSelections(comparator, comparator === currentSelection ? selection.options : currentSelection)\n\n          if (diff.length === 0 || !this.PRIVATE.isSlave) {\n            return\n          }\n\n          this.deselectAll()\n          selection.selectAll()\n          this.emit('options.selected', {\n            options: selection.options,\n            previous: this.selectedOptions,\n            next: new (generateAuthorHTMLCollectionConstructor())(selection.displayElements)\n          }, this.parentNode)\n\n          // let { beforeChange } = this.parentNode\n          //\n          // let detail = {\n          //   options: selection.options,\n          //   previous: this.selectedOptions,\n          //   next: new (generateAuthorHTMLCollectionConstructor())(selection.displayElements)\n          // }\n          //\n          // let cb = () => {\n          //   this.deselectAll()\n          //   selection.selectAll()\n          //   return this.emit('options.selected', detail, this.parentNode)\n          // }\n          //\n          // if (!(beforeChange && typeof beforeChange === 'function')) {\n          //   return cb()\n          // }\n          //\n          // beforeChange(this.selectedOptions, detail.next, cb)\n        }\n\n        if (!this.multiple) {\n          return completeOperation(new Selection([this.options[index]]))\n        }\n\n        if (keyboard) {\n          return this.PRIVATE.handleKeyboardSelection(evt.detail, completeOperation)\n        }\n\n        return this.PRIVATE.handleClickSelection(evt.detail, completeOperation)\n      },\n\n      parentStateChangeHandler: evt => {\n        this.emit('state.change', evt.detail)\n\n        let { name, value } = evt.detail\n\n        switch (name) {\n          case 'multiple':\n            if (!value && this.selectedOptions.length > 0) {\n              let index = this.selectedIndex\n\n              this.deselectAll()\n              this.emit('option.selected', { index })\n            }\n\n            break\n\n          default: return\n        }\n      }\n    })\n\n    this.UTIL.registerListeners(this, {\n      connected: () => {\n        this.PRIVATE.selectionStartIndex = this.selectedIndex >= 0 ? this.selectedIndex : 0\n\n        if (this.PRIVATE.isSlave) {\n          this.parentNode.on('state.change', this.PRIVATE.parentStateChangeHandler)\n        }\n      },\n\n      disconnected: () => {\n        if (this.PRIVATE.isSlave) {\n          this.parentNode.off('state.change', this.PRIVATE.parentStateChangeHandler)\n        }\n      },\n\n      'keydown.arrowUp': this.PRIVATE.arrowUpHandler,\n      'keydown.arrowDown': this.PRIVATE.arrowDownHandler,\n      'option.selected': this.PRIVATE.optionSelectionHandler\n    })\n  }\n\n  get selectedIndex () {\n    return this.selectedOptions.length > 0\n      ? this.selectedOptions.item(0).index\n      : -1\n  }\n\n  set selectedIndex (index) {\n    this.emit('option.selected', { index })\n  }\n\n  get selectionStartIndex () {\n    return this.PRIVATE.selectionStartIndex\n  }\n\n  set selectionStartIndex (value) {\n    this.UTIL.throwError({\n      type: 'readonly',\n      message: `\"selectionStartIndex\" cannot be set manually.`\n    })\n  }\n\n  addOptgroup (optgroup) {\n    let label = document.createElement('author-optgroup-label')\n    label.innerHTML = optgroup.getAttribute('label')\n\n    this.appendChild(label)\n    this.appendChild(optgroup)\n  }\n\n  addOption (option, index = null, dest = this) {\n    if (!customElements.get('author-option')) {\n      return this.UTIL.throwError({\n        type: 'dependency',\n        vars: {\n          name: 'author-option'\n        }\n      })\n    }\n\n    if (option instanceof Option) {\n      option = this.PRIVATE.generateOptionObject(option)\n    }\n\n    if (this.PRIVATE.isSlave) {\n      this.parentNode[`${option.index}`] = option.displayElement\n    }\n\n    if (index) {\n      dest.insertBefore(option.displayElement, dest.children.item(index))\n\n      this.options.splice(index, 0, option)\n\n      if (this.PRIVATE.isSlave) {\n        this.parentNode.sourceElement.add(option.sourceElement, index)\n      }\n\n    } else {\n      dest.appendChild(option.displayElement)\n      this.options.push(option)\n\n      if (this.PRIVATE.isSlave && !this.parentNode.sourceElement[this.options.length - 1]) {\n        this.parentNode.sourceElement.appendChild(option.sourceElement)\n      }\n    }\n\n    if (option.selected) {\n      if (!this.multiple) {\n        this.selectedIndex = option.index\n        return\n      }\n    }\n  }\n\n  addOptions (children) {\n    Array.from(children).forEach(child => {\n      let isElement = child instanceof HTMLElement\n\n      switch (child.nodeName) {\n        case 'OPTION':\n          return this.addOption(isElement ? this.PRIVATE.generateOptionObject(child) : child)\n\n        case 'OPTGROUP':\n          return this.addOptgroup(isElement ? this.PRIVATE.generateOptgroup(child) : child)\n\n        default:\n          return this.UTIL.printToConsole(`${child.nodeName.toLowerCase()} is not a valid child element for <author-select>. Removing...`, 'warning')\n      }\n    })\n  }\n\n  clear () {\n    while (this.lastChild) {\n      this.removeChild(this.lastChild)\n    }\n  }\n\n  deselect (option, updateList = true) {\n    if (typeof option === 'number') {\n      option = this.options[option]\n    }\n\n    option.selected = false\n\n    if (this.PRIVATE.isSlave && this.selectedOptionsElement !== undefined) {\n      this.parentNode.selectedOptionsElement.remove(option, updateList)\n    }\n  }\n\n  deselectAll (showPlaceholder = true) {\n    this.options.filter(option => option.selected).forEach((option, index, options) => {\n      this.deselect(option, index = options.length - 1 && showPlaceholder)\n    })\n  }\n\n  hoverOption (index) {\n    this.unHoverAllOptions()\n    this.options[index].displayElement.hover = true\n  }\n\n  item (index) {\n    return this.options[index].displayElement\n  }\n\n  namedItem (value) {\n    let query = this.options.filter(option => {\n      let id = option.sourceElement.attributes.getNamedItem('id')\n      return id && id.value === value\n    })\n\n    if (!query.length) {\n      return null\n    }\n\n    return query[query.length - 1].displayElement\n  }\n\n  /**\n   * @method removeOptionByIndex\n   * @param  {Number}  [index=null]\n   * Index of option to remove\n   * @param  {Boolean} [destroy=true]\n   */\n  removeOptionByIndex (index = null) {\n    if (index === null || index >= this.options.length) {\n      return\n    }\n\n    this.options[index].remove()\n  }\n\n  unHoverAllOptions () {\n    this.options.forEach((option, index) => this.unHoverOption(index))\n  }\n\n  unHoverOption (index) {\n    this.options[index].displayElement.hover = false\n  }\n}\n\ncustomElements.define('author-options', AuthorOptionsElement)\n\nexport default AuthorOptionsElement\n"],"names":["AuthorOptionsElement","UTIL","defineProperties","cherryPickedOptions","private","form","readonly","get","parentNode","displayOptions","AuthorHTMLOptionsCollection","PRIVATE","generateAuthorHTMLOptionsCollectionConstructor","array","options","map","option","displayElement","addFunction","element","before","addOption","generateOptionObject","removeFunction","index","removeOptionByIndex","selectedIndex","hoveredIndex","findIndex","hover","isSlave","localName","lastSelectedIndex","multiple","default","selectedIndices","selectedOptions","nodes","querySelectorAll","AuthorHTMLCollection","generateAuthorHTMLCollectionConstructor","Selection","push","includes","unshift","forEach","selected","length","selectionStartIndex","visibleOptions","filter","hidden","definePrivateMethods","arrowDownHandler","evt","startIndex","detail","hoverOption","emit","keyboard","shiftKey","ctrlKey","metaKey","arrowUpHandler","diffSelections","comparator","comparable","_p","WeakMap","arr","add","remove","set","Symbol","toStringTag","generateOptgroup","optgroup","customElements","throwError","type","vars","name","surrogate","document","createElement","id","generateGuid","label","getAttribute","trim","message","setAttribute","Array","from","sourceElement","OptionConstructor","generateOptionConstructor","parent","key","defaultSelected","innerHTML","attributes","attr","value","removeAttribute","disabled","textContent","hasAttribute","text","setAttr","bool","getCurrentSelection","handleClickSelection","cb","selectedOption","clear","bounds","sort","a","b","slice","currentSelection","handleKeyboardSelection","selection","optionSelectionHandler","completeOperation","diff","deselectAll","selectAll","previous","next","displayElements","parentStateChangeHandler","registerListeners","connected","on","disconnected","off","appendChild","dest","Option","insertBefore","children","item","splice","child","isElement","HTMLElement","nodeName","addOptgroup","printToConsole","toLowerCase","lastChild","removeChild","updateList","selectedOptionsElement","undefined","showPlaceholder","deselect","unHoverAllOptions","query","getNamedItem","unHoverOption","AuthorBaseElement","define"],"mappings":"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"}